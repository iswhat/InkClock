# 家用网络智能墨水屏万年历 - 开发硬件说明

## 一、开发板说明

### 1.1 ESP32-S3开发板

ESP32-S3是乐鑫公司推出的一款低功耗WiFi+蓝牙双模微控制器，具有以下特点：

| 参数 | 规格 |
|------|------|
| 处理器 | 双核32位Xtensa® LX7处理器，主频240MHz |
| 内存 | 512KB SRAM，支持外部8MB PSRAM |
| 存储 | 16MB Flash（默认），支持更大容量 |
| WiFi | 802.11 b/g/n，支持2.4GHz频段 |
| 蓝牙 | Bluetooth 5.0 LE |
| 外设 | 45个GPIO引脚，支持ADC、DAC、I2C、SPI、UART等多种接口 |
| 电源 | 3.3V工作电压，支持5V DC输入 |
| 功耗 | 深度睡眠模式下功耗<5μA |
| 温度范围 | -40℃ ~ 85℃ |

### 1.2 开发板推荐

- **ESP32-S3-DevKitC-1**：乐鑫官方开发板，引脚全部引出，便于开发和调试
- **ESP32-S3-Box**：乐鑫官方开发套件，内置屏幕、摄像头、麦克风等外设
- **ESP32-S3-LCD-EV-Board**：适合墨水屏应用的开发板，内置LCD控制器

## 二、墨水屏说明

### 2.1 墨水屏特点

墨水屏（电子纸）具有以下特点：

- 低功耗：仅在刷新时消耗电能，静态显示时几乎不耗电
- 高清晰度：显示清晰，分辨率高
- 宽视角：可从各个角度清晰查看
- 阳光下可读：适合户外使用
- 无蓝光：对眼睛友好
- 响应速度慢：刷新速度一般为数百毫秒到几秒
- 颜色有限：通常为黑白或黑白红三色

### 2.2 支持的墨水屏尺寸

系统支持以下尺寸的墨水屏：

| 尺寸 | 分辨率 | 接口 | 驱动芯片 |
|------|--------|------|----------|
| 1.54英寸 | 200×200 | SPI | GDEW0154M09 |
| 2.13英寸 | 212×104 | SPI | GDEW0213M09 |
| 2.66英寸 | 152×296 | SPI | GDEW0266M09 |
| 2.7英寸 | 264×176 | SPI | GDEW027W3 |
| 2.9英寸 | 296×128 | SPI | GDEW029T5 |
| 3.12英寸 | 250×300 | SPI | GDEW031T7 |
| 4.2英寸 | 400×300 | SPI | GDEW042T2 |
| 4.37英寸 | 544×376 | SPI | GDEW0437M13 |
| 5.4英寸 | 600×448 | SPI | GDEW054Z09 |
| 5.83英寸 | 648×480 | SPI | GDEW0583T7 |
| 6.0英寸 | 800×600 | SPI | GDEW060T3 |
| 7.5英寸 | 800×480 | SPI | GDEW075T7 |

### 2.3 墨水屏连接说明

墨水屏通过SPI接口与ESP32-S3连接，典型连接方式如下：

| 墨水屏引脚 | ESP32-S3引脚 | 说明 |
|------------|--------------|------|
| VCC | 3.3V | 电源正极 |
| GND | GND | 电源负极 |
| SCK | GPIO18 | SPI时钟引脚 |
| MOSI | GPIO23 | SPI数据输出引脚 |
| MISO | GPIO19 | SPI数据输入引脚（可选，某些墨水屏不需要） |
| CS | GPIO5 | 片选引脚 |
| DC | GPIO26 | 数据/命令切换引脚 |
| RST | GPIO27 | 复位引脚 |
| BUSY | GPIO32 | 忙状态引脚（可选，用于检测刷新完成） |

## 三、传感器说明

### 3.1 温湿度传感器

系统支持以下温湿度传感器：

#### 3.1.1 DHT22传感器

| 参数 | 规格 |
|------|------|
| 类型 | 数字温湿度传感器 |
| 测量范围 | 温度：-40℃ ~ 80℃，湿度：0% ~ 100% RH |
| 精度 | 温度：±0.5℃，湿度：±2% RH |
| 接口 | 单总线 |
| 供电 | 3.3V ~ 5V |
| 响应时间 | 2s |

**连接方式：**
| DHT22引脚 | ESP32-S3引脚 |
|-----------|--------------|
| VCC | 3.3V |
| GND | GND |
| DATA | GPIO4 |

#### 3.1.2 SHT30传感器

| 参数 | 规格 |
|------|------|
| 类型 | 数字温湿度传感器 |
| 测量范围 | 温度：-40℃ ~ 125℃，湿度：0% ~ 100% RH |
| 精度 | 温度：±0.3℃，湿度：±2% RH |
| 接口 | I2C |
| 供电 | 2.4V ~ 5.5V |
| 响应时间 | <1s |
| I2C地址 | 0x44（默认）或0x45 |

**连接方式：**
| SHT30引脚 | ESP32-S3引脚 |
|-----------|--------------|
| VCC | 3.3V |
| GND | GND |
| SCL | GPIO22 |
| SDA | GPIO21 |

#### 3.1.3 其他温湿度传感器

系统还支持以下温湿度传感器：

- **DHT11**：数字温湿度传感器，单总线接口，精度较低但价格便宜
- **DHT12**：数字温湿度传感器，I2C接口，适合空间有限的应用
- **SHT21**：数字温湿度传感器，I2C接口，精度高
- **SHT40**：数字温湿度传感器，I2C接口，响应速度快
- **AM2302**：防水版DHT22，适合户外应用
- **HDC1080**：数字温湿度传感器，I2C接口，低功耗
- **BME280**：温湿度气压传感器，I2C/SPI接口，适合天气预测
- **BME680**：温湿度气压气体传感器，I2C/SPI接口，功能丰富
- **HTU21D**：数字温湿度传感器，I2C接口，与SHT21兼容
- **SI7021**：数字温湿度传感器，I2C接口，与SHT21兼容

### 3.2 人体感应传感器

系统支持以下人体感应传感器：

#### 3.2.1 HC-SR501传感器

| 参数 | 规格 |
|------|------|
| 类型 | 被动红外人体感应传感器 |
| 检测距离 | 3-7米 |
| 检测角度 | 110° |
| 供电 | 5V |
| 接口 | 数字输出 |

**连接方式：**
| HC-SR501引脚 | ESP32-S3引脚 |
|--------------|--------------|
| VCC | 5V |
| GND | GND |
| OUT | GPIO5 |

#### 3.2.2 其他人体感应传感器

- **HC-SR505**：小型化人体感应传感器，适合空间有限的应用
- **RE200B**：高灵敏度红外传感器，适合远距离检测
- **LD2410**：毫米波雷达人体感应传感器，支持距离检测

### 3.3 光照传感器

系统支持以下光照传感器：

#### 3.3.1 BH1750传感器

| 参数 | 规格 |
|------|------|
| 类型 | 数字光照传感器 |
| 测量范围 | 1-65535 lx |
| 精度 | ±20% |
| 接口 | I2C |
| 供电 | 3.3V ~ 5V |
| I2C地址 | 0x23（默认）或0x5C |

**连接方式：**
| BH1750引脚 | ESP32-S3引脚 |
|------------|--------------|
| VCC | 3.3V |
| GND | GND |
| SCL | GPIO22 |
| SDA | GPIO21 |

#### 3.3.2 其他光照传感器

- **VEML6075**：UV光照传感器，用于检测紫外线强度
- **TSL2561**：数字光照传感器，支持宽动态范围
- **GY30**：数字光照传感器，精度高，适合专业应用
- **SI1145**：环境光和UV传感器，功能丰富

### 3.4 气体传感器

系统支持以下气体传感器：

#### 3.4.1 MQ-135传感器

| 参数 | 规格 |
|------|------|
| 类型 | 半导体气体传感器 |
| 检测气体 | 甲醛、苯、甲苯、NH3、NOx等多种有害气体 |
| 测量范围 | 10-1000 ppm |
| 接口 | 模拟输出 |
| 供电 | 5V |

**连接方式：**
| MQ-135引脚 | ESP32-S3引脚 |
|------------|--------------|
| VCC | 5V |
| GND | GND |
| A0 | GPIO34 |

#### 3.4.2 其他气体传感器

- **MQ-2**：可检测烟雾、燃气、甲烷等气体
- **MQ-5**：可检测液化石油气、甲烷、丙烷等气体
- **MQ-7**：可检测一氧化碳气体
- **MQ-8**：可检测氢气
- **TGS2600**：可检测多种挥发性有机化合物

### 3.5 火焰传感器

系统支持以下火焰传感器：

#### 3.5.1 红外火焰传感器

| 参数 | 规格 |
|------|------|
| 类型 | 红外火焰传感器 |
| 检测距离 | 0.1-1米（可调节） |
| 检测波长 | 760-1100 nm |
| 接口 | 数字输出 |
| 供电 | 3.3V ~ 5V |

**连接方式：**
| 火焰传感器引脚 | ESP32-S3引脚 |
|----------------|--------------|
| VCC | 3.3V |
| GND | GND |
| OUT | GPIO35 |

#### 3.5.2 其他火焰传感器

- **UV火焰传感器**：检测紫外线，适合检测明火
- **YG1006**：红外火焰传感器，灵敏度高
- **MQ-2**：可检测烟雾和火焰
- **TGS2600**：可检测火灾产生的烟雾

## 四、电源模块说明

### 4.1 锂电池

**仅支持软包聚合物电池**，容量根据需求选择：

- **小尺寸墨水屏（1.54-3.12英寸）**：1000mAh ~ 3000mAh，软包聚合物电池
- **中尺寸墨水屏（4.2-5.83英寸）**：2000mAh ~ 5000mAh，软包聚合物电池
- **大尺寸墨水屏（6.0-7.5英寸）**：4000mAh ~ 6000mAh，软包聚合物电池

### 4.2 充电模块

**仅支持USB-Type-C接口充电**，推荐使用以下充电模块：

#### 4.2.1 Type-C充电模块

| 参数 | 规格 |
|------|------|
| 接口类型 | USB-Type-C |
| 输入电压 | 5V DC |
| 充电功率 | 10W-20W |
| 充电电流 | 2A（可调节） |
| 过充保护 | 4.2V ±1% |
| 过放保护 | 3.0V |
| 短路保护 | 支持 |
| 反接保护 | 支持 |

**连接方式：**
| Type-C充电模块引脚 | 连接对象 |
|-------------------|----------|
| VCC | USB-Type-C输入 |
| GND | GND |
| B+ | 软包聚合物电池正极 |
| B- | 软包聚合物电池负极 |
| OUT+ | 输出正极（连接ESP32-S3的VIN或3.3V） |
| OUT- | 输出负极（连接ESP32-S3的GND） |

#### 4.2.2 其他推荐充电模块

- **TP4056+Type-C**：USB-Type-C接口，10W充电，带充电保护
- **AXP192+Type-C**：USB-Type-C接口，10W-15W充电，功能强大

### 4.3 电源管理模块

推荐使用AXP192+Type-C电源管理模块，具有以下特点：

| 参数 | 规格 |
|------|------|
| 接口类型 | USB-Type-C |
| 输入电压 | 3.0V ~ 5.5V |
| 充电功率 | 10W-20W |
| 输出通道 | 6路DC-DC输出，2路LDO输出 |
| 最大输出电流 | 每路3A |
| 功耗 | 工作模式下<10mA，深度睡眠模式下<10μA |
| 功能 | 支持电量监测、充电管理、电源开关等功能 |
| 接口 | I2C |

**连接方式：**
| AXP192引脚 | ESP32-S3引脚 |
|------------|--------------|
| VIN | USB-Type-C输入或软包聚合物电池正极 |
| GND | GND |

### 4.4 供电说明

- **仅支持USB-Type-C充电**，不支持DC直插供电
- 充电功率范围：10W-20W
- 工作电压：3.3V
- 电池电压：3.3V-4.2V（软包聚合物电池）
| SCL | GPIO22 |
| SDA | GPIO21 |
| EXTEN | ESP32-S3的EN引脚 |
| VOUT2 | ESP32-S3的3.3V引脚 |

## 五、按键说明

### 5.1 按键类型

推荐使用轻触按键，具有以下特点：

- 操作手感好
- 寿命长：一般可达10万次以上
- 体积小：便于安装
- 价格便宜

### 5.2 按键连接

按键采用上拉电阻连接方式，连接图如下：

```
ESP32-S3 GPIO --+-- [10KΩ电阻] --+ 3.3V
               |                  |
               +-- [轻触按键] ----+ GND
```

**连接方式：**
| 按键引脚 | ESP32-S3引脚 |
|----------|--------------|
| 按键1 | GPIO0 |
| 按键2 | GPIO1 |
| 按键3 | GPIO2 |
| 按键4 | GPIO3 |

每个按键需要串联一个10KΩ的上拉电阻。

## 六、外壳说明

### 6.1 3D打印外壳

系统提供3D打印模型文件，位于`hardware/3d_models`目录下，支持以下尺寸的墨水屏：

- 1.54英寸
- 2.13英寸
- 2.9英寸
- 4.2英寸
- 7.5英寸

### 6.2 3D打印参数

- **材料**：PLA或ABS
- **层高**：0.2mm
- **填充密度**：20% ~ 30%
- **支撑**：根据模型需要添加
- **打印速度**：50mm/s ~ 80mm/s

### 6.3 购买成品外壳

可以在淘宝、京东等平台搜索"ESP32墨水屏外壳"，选择合适的尺寸和款式。

## 七、硬件连接示例

### 7.1 基本连接示例

以下是一个基本的硬件连接示例，使用ESP32-S3-DevKitC-1开发板和2.9英寸墨水屏：

| 组件 | 连接关系 |
|------|----------|
| ESP32-S3-DevKitC-1 | 主控制器 |
| 2.9英寸墨水屏 | VCC→3.3V, GND→GND, SCK→GPIO18, MOSI→GPIO23, CS→GPIO5, DC→GPIO26, RST→GPIO27, BUSY→GPIO32 |
| DHT22传感器 | VCC→3.3V, GND→GND, DATA→GPIO4 |
| 锂电池 | 通过TP4056充电模块连接到ESP32-S3的VIN引脚 |
| 按键 | 4个轻触按键，分别连接到GPIO0、GPIO1、GPIO2、GPIO3，每个按键串联一个10KΩ上拉电阻 |

### 7.2 扩展连接示例

以下是一个扩展的硬件连接示例，使用ESP32-S3-Box开发板和7.5英寸墨水屏：

| 组件 | 连接关系 |
|------|----------|
| ESP32-S3-Box | 主控制器，内置屏幕、摄像头、麦克风等外设 |
| 7.5英寸墨水屏 | VCC→3.3V, GND→GND, SCK→GPIO18, MOSI→GPIO23, CS→GPIO5, DC→GPIO26, RST→GPIO27, BUSY→GPIO32 |
| SHT30传感器 | VCC→3.3V, GND→GND, SCL→GPIO22, SDA→GPIO21 |
| AXP192电源管理模块 | VIN→锂电池正极, GND→GND, SCL→GPIO22, SDA→GPIO21, VOUT2→ESP32-S3的3.3V引脚 |
| 锂电池 | 5000mAh，连接到AXP192的VIN引脚 |
| BH1750光照传感器 | VCC→3.3V, GND→GND, SCL→GPIO22, SDA→GPIO21 |

## 八、硬件测试

### 8.1 电源测试

1. 使用万用表测量开发板的3.3V和5V引脚电压，确保电压稳定
2. 测量锂电池的电压，确保电池电量充足
3. 测试充电功能，确保锂电池能够正常充电

### 8.2 墨水屏测试

1. 上传测试代码，测试墨水屏是否能够正常显示
2. 测试不同刷新模式（全刷、局部刷）的效果
3. 测试不同内容的显示效果（文本、图形、图标等）

### 8.3 传感器测试

1. 上传测试代码，测试传感器是否能够正常采集数据
2. 测试传感器的精度和稳定性
3. 测试传感器在不同环境下的表现

### 8.4 按键测试

1. 上传测试代码，测试按键是否能够正常响应
2. 测试按键的灵敏度和可靠性
3. 测试按键的消抖效果

## 九、开发工具

### 9.1 硬件工具

- **USB数据线**：用于连接开发板和电脑
- **万用表**：用于测量电压、电流、电阻等
- **电烙铁**：用于焊接元件
- **热风枪**：用于焊接贴片元件
- **示波器**：用于调试信号
- **逻辑分析仪**：用于分析数字信号

### 9.2 软件工具

- **Visual Studio Code**：代码编辑和开发环境
- **PlatformIO**：ESP32开发框架和工具链
- **Arduino IDE**：ESP32开发环境
- **ESP-IDF**：乐鑫官方开发框架
- **Serial Monitor**：串口调试工具
- **Web浏览器**：用于访问Web配置页面

## 十、常见问题解决

### 10.1 开发板无法启动

- 检查电源连接是否正确
- 检查锂电池是否有电
- 检查复位引脚是否正常
- 检查固件是否正确上传

### 10.2 墨水屏无法显示

- 检查墨水屏连接是否正确
- 检查墨水屏驱动是否兼容
- 检查固件是否支持该尺寸的墨水屏
- 尝试重启设备

### 10.3 传感器数据异常

- 检查传感器连接是否正确
- 检查传感器电源是否正常
- 检查传感器驱动是否正确
- 尝试校准传感器

### 10.4 按键无响应

- 检查按键连接是否正确
- 检查上拉电阻是否连接
- 检查按键是否损坏
- 检查固件中的按键处理逻辑是否正确

### 10.5 无法连接WiFi

- 检查WiFi密码是否正确
- 检查WiFi信号强度
- 检查WiFi模块是否正常
- 尝试重启设备

## 十一、资源获取

1. ESP32-S3 datasheet：https://www.espressif.com.cn/en/products/socs/esp32-s3
2. 墨水屏 datasheet：根据具体型号从制造商网站获取
3. 3D打印模型：`hardware/3d_models`目录
4. 电路图：`elec/电路设计.md`
5. 测试代码：`examples`目录

## 十二、注意事项

1. **静电防护**：在操作ESP32-S3和墨水屏时，注意静电防护，避免损坏电子元件
2. **电源安全**：使用锂电池时，注意防止过充和过放
3. **引脚连接**：确保引脚连接正确，避免短路
4. **焊接质量**：确保焊接质量良好，避免虚焊和短路
5. **散热设计**：如果设备功耗较高，注意散热设计
6. **防水设计**：如果设备用于户外，注意防水设计
7. **EMC设计**：注意电磁兼容性设计，避免干扰其他设备
8. **可靠性设计**：注意设备的可靠性设计，提高设备的使用寿命
