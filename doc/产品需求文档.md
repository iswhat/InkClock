# 家用网络智能墨水屏万年历需求规划

## 1. 产品概述

家用网络智能墨水屏万年历是一款集传统万年历功能与现代智能科技于一体的家居电子产品。它采用低功耗墨水屏显示，结合WiFi联网功能，实现了天气预报、温度湿度监测、远程推送留言、股票曲线显示等多种智能功能，并支持插件扩展，可根据用户需求定制更多功能。产品采用轻薄设计，厚度不超过3cm，使用聚合物软包电池和Type-C充电接口，续航可达50天以上，最高可达150天。

## 2. 功能需求

### 2.1 核心功能

| 功能模块 | 详细描述 |
|---------|---------|
| 时钟显示 | 实时显示时间、日期，支持24/12小时制切换，提供数字和模拟表盘两种显示模式，支持区域刷新 |
| 万年历功能 | 显示农历、节气、节日等信息 |
| 温度湿度监测 | 实时监测室内温度和湿度，显示历史数据趋势 |
| 天气预报 | 显示未来3-7天天气预报，包括温度、天气状况、风力风向等 |
| WiFi联网 | 支持2.4GHz WiFi连接，自动获取网络时间和天气信息 |
| 蓝牙配置 | 首次使用时通过蓝牙连接引导配置WiFi连接 |
| 电量显示 | 显示剩余电量和充电状态 |
| Web管理界面 | 通过浏览器访问设备IP地址的8080端口，进入设备设置界面，支持所有设置操作 |
| 低功耗模式 | 通过HC-SR501人体感应传感器检测无人状态，自动进入低损耗模式：<br>1. 检测逻辑：连续5分钟未检测到人体活动，自动进入低功耗模式<br>2. 刷新策略：进入低功耗模式后，屏幕刷新间隔从1分钟延长至1小时，仅显示核心时间日期信息<br>3. 省电逻辑：关闭非必要功能模块，降低CPU运行频率，减少WiFi连接次数<br>4. 唤醒机制：人体感应传感器检测到活动后，5秒内自动唤醒，恢复正常刷新频率 |

### 2.2 智能功能

| 功能模块 | 详细描述 |
|---------|---------|
| 远程推送文字留言 | 支持手机APP或Web端远程推送文字留言到设备 |
| 远程推送音频留言 | 支持手机APP或Web端远程推送音频留言，设备可播放 |
| 本地语音留言 | 支持本地录音留言功能 |
| 指定股票曲线 | 支持添加指定股票代码，显示股票价格和K线图 |
| 插件支持 | 通过加载Web页面显示插件内容，WiFi连接后在手机端管理；支持填写功能页面URL并设置刷新时间（单位为秒、分、时、天）；通过URL获取页面的代码解析：显示内容、基础布局和名称，不支持解析任何复杂格式或者效果 |

### 2.3 显示功能

| 功能模块 | 详细描述 |
|---------|---------|
| 墨水屏显示 | 采用4.2寸-7.5寸三色墨水屏，低功耗、高对比度，支持区域刷新 |
| 左右分屏布局 | 左侧固定显示：时间、网络来源天气、室温监测、电量、消息通知；右侧可切换显示：万年历（带黄历）、留言板、股票、插件功能（轮换）、插件管理、设置等 |
| 多页面切换 | 支持右侧区域功能切换，可通过按键或远程控制切换 |
| 区域刷新 | 时钟区域支持独立刷新，减少全屏刷新次数，降低功耗 |
| 自定义布局 | 支持用户自定义页面布局，调整各功能模块位置和大小 |
| 定时刷新 | 支持定时刷新屏幕，可设置刷新频率 |
| 时钟显示模式 | 支持数字和模拟表盘两种显示模式，可切换 |
| 设置界面 | 设备端设置界面仅显示设置信息和访问设置的二维码，扫码直接访问 http://ip:8080 |
| 智能屏幕适配 | 根据屏幕尺寸自动调整布局比例：<br>1. 小屏幕（< 400px高度）：紧凑布局，优先显示核心内容，分屏比例1:1（左右各占一半），较小字体节省空间<br>2. 大屏幕（≥ 400px高度）：宽松布局，展示更多信息，分屏比例1:2（左侧1/3，右侧2/3），较大字体提高可读性<br>3. 自适应字体大小和元素间距<br>4. 动态分屏比例（小屏1:1，大屏1:2）<br>5. 所有页面都实现智能适配，包括主页面、消息页面、日历页面、股票页面、插件页面和设置页面 |

### 2.4 交互功能

| 功能模块 | 详细描述 |
|---------|---------|
| 物理按键 | 提供少量物理按键，用于页面切换、音量调节等基本操作 |
| 远程控制 | 支持手机APP或Web端远程控制设备 |
| 语音控制 | 可选支持语音唤醒和控制功能 |

### 2.5 电源管理

| 功能模块 | 详细描述 |
|---------|---------|
| 低功耗设计 | 采用低功耗处理器和墨水屏，支持电池供电，续航可达50天以上，最高可达150天 |
| 电源管理 | 支持自动休眠和唤醒功能，延长电池寿命 |
| 充电功能 | 支持Type-C充电，提供充电指示和电量显示 |
| 电池类型 | 使用聚合物软包电池，轻薄设计，厚度不超过3cm |

## 3. 硬件需求

### 3.1 核心硬件

| 硬件模块 | 需求描述 |
|---------|---------|
| 处理器 | 支持WiFi和蓝牙连接，性能足够运行实时操作系统和各种功能模块 |
| 内存 | 足够存储操作系统、应用程序和数据 |
| 存储 | 支持外部存储扩展，用于存储音频留言、插件等 |
| 墨水屏 | 4.2寸-7.5寸三色墨水屏，支持区域刷新，分辨率不低于800×480 |
| 网络模块 | 2.4GHz WiFi模块，支持802.11b/g/n协议 |
| 蓝牙模块 | 支持蓝牙4.2或以上版本，用于首次WiFi配置 |
| 传感器 | 温湿度传感器，精度不低于±0.5℃/±3%RH |

### 3.2 扩展硬件

| 硬件模块 | 需求描述 |
|---------|---------|
| 音频模块 | 支持录音和播放功能，内置麦克风和扬声器 |
| 按键 | 3-5个物理按键，用于基本操作 |
| 电源模块 | 支持Type-C充电，内置聚合物软包电池，厚度不超过3cm |
| 扩展接口 | 支持GPIO、I2C、SPI等接口，用于插件扩展 |

## 4. 软件需求

### 4.1 操作系统

| 需求描述 |
|---------|
| 支持实时操作系统，如FreeRTOS、RT-Thread等 |
| 低功耗设计，支持休眠和唤醒功能 |
| 支持WiFi连接和网络通信 |
| 支持蓝牙4.2或以上版本，用于首次WiFi配置 |

### 4.2 应用程序

| 功能模块 | 需求描述 |
|---------|---------|
| 时钟模块 | 实时显示时间、日期，支持农历转换 |
| 天气模块 | 从网络获取天气预报数据，解析和显示 |
| 传感器模块 | 读取温湿度传感器数据，存储和显示历史趋势 |
| 留言模块 | 支持文字和音频留言的接收、存储和播放 |
| 股票模块 | 从网络获取股票数据，绘制K线图 |
| 蓝牙配置模块 | 首次使用时通过蓝牙提供WiFi配置引导 |
| Web服务器模块 | 提供HTTP服务，支持浏览器访问设备设置界面（端口8080） |
| 插件管理 | 支持插件的安装、卸载和管理，通过Web页面加载插件内容 |
| Web插件加载 | 支持通过URL获取页面代码，解析显示内容、基础布局和名称，设置刷新时间 |
| 二维码生成 | 生成访问设置界面的二维码，扫码直接访问 http://ip:8080 |
| 远程通信 | 支持与手机APP或Web端的通信协议 |

### 4.3 手机APP/Web端

| 功能模块 | 需求描述 |
|---------|---------|
| 设备管理 | 支持设备的添加、删除和配置 |
| 远程控制 | 支持远程控制设备的各种功能 |
| 留言推送 | 支持文字和音频留言的推送 |
| 数据查看 | 支持查看设备的历史数据，如温湿度、股票等 |
| 插件管理 | 支持插件的下载、安装、配置和管理 |
| Web插件配置 | 支持填写插件功能页面URL，设置刷新时间（秒、分、时、天） |
| 浏览器访问 | 支持通过浏览器访问设备IP地址的8080端口，进入设备设置界面 |

## 5. 性能需求

| 性能指标 | 需求描述 |
|---------|---------|
| 响应时间 | 按键操作响应时间不超过1秒 |
| 刷新时间 | 墨水屏刷新时间不超过3秒 |
| 网络延迟 | 远程推送消息延迟不超过5秒 |
| 电池寿命 | 电池供电模式下，单次充电可使用7-15天 |
| 稳定性 | 设备连续运行30天无故障 |

## 6. 成本需求

| 版本 | 成本预算 | 续航要求 |
|------|---------|---------|
| 入门版 | 100元以下 | 30天以上 |
| 基础版 | 200元左右 | 50天以上 |
| 增强版 | 300元左右 | 150天以上 |

## 7. 扩展性需求

| 需求描述 |
|---------|
| 支持硬件扩展，可通过扩展接口添加新的传感器或模块 |
| 支持软件扩展，可通过插件机制添加新的功能 |
| 支持固件升级，可通过WiFi远程升级固件 |

## 8. 可靠性需求

| 需求描述 |
|---------|
| 设备工作温度范围：-10℃ ~ 50℃ |
| 设备工作湿度范围：10%RH ~ 90%RH |
| 抗震性能：可承受轻微震动和碰撞 |
| 抗干扰性能：可抵抗普通家庭环境中的电磁干扰 |

## 9. 外观设计需求

| 需求描述 |
|---------|
| 简洁美观，适合家居环境摆放 |
| 轻薄设计，便于安装和携带 |
| 按键布局合理，操作方便 |
| 提供多种颜色和款式选择 |

## 10. 后续扩展功能

| 功能模块 | 描述 |
|---------|------|
| 智能家居控制 | 支持控制智能家居设备，如灯光、插座等 |
| 快递信息显示 | 自动获取快递信息，显示物流状态 |
| 日历提醒 | 支持添加日历提醒，显示待办事项 |
| 新闻资讯 | 显示实时新闻资讯摘要 |
| 空气质量监测 | 可选添加空气质量传感器，显示PM2.5等指标 |